angular.module("ngRestfulCollection",[]).provider("$collection",function(){var a=this.defaults={preRequest:null,collectionKey:"data",idKey:"id"};this.$get=["$q","$http","$filter","$cacheFactory","$injector","$resourceLibrary",function(b,c,d,e,f,g){function h(a,b){this._meta={url:g.get(a),params:angular.copy(b)},this.data={collection:[]}}function i(a){return b.reject(a)}function j(a,b){return a+"/"+b}function k(a,b){var c=m(a,b[p.idKey]);c?angular.extend(c,b):a.push(b)}function l(a,b){var c={};return c[a]=b,c}function m(a,b){return d("filter")(a,l(p.idKey,b))[0]}function n(a){var b="";return angular.forEach(a[1],function(a,c){b+=c+a}),a[0]+b}var o=e("ng-restful-collection"),p=angular.copy(a),q=q?f.get(q):{run:function(){return b.when(!0)}};return h.prototype.get=function(a){var b=this,d=angular.copy(a||{}),e=!!d[p.idKey],f=e?j(b._meta.url,d[p.idKey]):b._meta.url;return e||angular.extend(d,b._meta.params),delete d[p.idKey],q.run().then(function(){return c.get(f,{params:d})},i).then(function(a){var c,d=a.data;return e?(k(b.data.collection,d),c=angular.copy(d)):(b.data.collection=d[p.collectionKey]||[],c=angular.copy(b.data.collection)),c},i)},h.prototype.save=function(a){var b=this,d=a[p.idKey]?j(b._meta.url,a[p.idKey]):b._meta.url;return q.run().then(function(){var b=a[p.idKey]?"put":"post";return c[b](d,a)},i).then(function(a){return k(b.data.collection,a.data),angular.copy(a.data)},i)},h.prototype.remove=function(a){var b=this;return q.run().then(function(){return c["delete"](j(b._meta.url,a[p.idKey]))},i).then(function(){var c=m(b.data.collection,a[p.idKey]),d=b.data.collection.indexOf(c);b.data.collection.splice(d,1)},i)},function(a,b){var c=n(arguments),d=o.get(c);if(d)return d;var e=new h(a,b);return o.put(c,e),e}}]}).provider("$resourceLibrary",function(){var a=this.defaults={baseLinks:{}};this.$get=["$cacheFactory",function(b){function c(a,b){b=b?b+".":"",angular.isArray(a)?angular.forEach(a,function(a){e.put(b+a.rel,a.uri)}):angular.isObject(a)&&angular.forEach(a,function(a,c){e.put(b+c,a)})}var d=angular.copy(a),e=b("resource-library");return c("",d.baseLinks),{extend:c,get:e.get}}]}).controller("ngRestfulCollectionCtrl",["$scope","$attrs","$parse","$collection",function(a,b,c,d){function e(a){return a.replace(/\./g," ").replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(a,b){return 0===b?a.toLowerCase():a.toUpperCase()})}function f(a){return function(b){a&&a(b)}}var g=c(b.ngRestfulCollection)(a);a.getEditCopy=angular.copy,angular.forEach(g,function(b){var c=d(b.type,b.params),g=e(b.type);a[g]=angular.extend({data:c.data,save:function(a,b,d){c.save(a).then(f(b),f(d))},remove:function(a,b,d){c.remove(a).then(f(b),f(d))}},a[g]),c.get()})}]).directive("ngRestfulCollection",function(){return{restrict:"A",controller:"ngRestfulCollectionCtrl"}});
//# sourceMappingURL=ng-restful-collection.min.map