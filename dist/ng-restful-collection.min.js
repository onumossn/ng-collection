!function(a,b,c){"use strict";b.module("ngRestfulCollection",[]).provider("$collection",function(){var a=this.defaults={preRequest:null,collectionKey:"data",idKey:"id"};this.$get=["$q","$http","$filter","$cacheFactory","$injector","$rootScope","$resourceLibrary",function(c,d,e,f,g,h,i){function j(a,c){this._meta={type:a,url:i.get(a),params:b.copy(c)},this.data={collection:[]}}function k(a){return c.reject(a)}function l(a,b){return a+"/"+b}function m(a,c){var d=o(a,c[r.idKey]);d?b.extend(d,c):a.push(c)}function n(a,b){var c={};return c[a]=b,c}function o(a,b){return e("filter")(a,n(r.idKey,b))[0]}function p(a){var c="";return b.forEach(a[1],function(a,b){c+=b+a}),a[0]+c}var q=f("ng-restful-collection"),r=b.copy(a),s=s?g.get(s):{run:function(){return c.when(!0)}};return j.prototype.get=function(a){var e=this,f=b.copy(a||{}),g=!!f[r.idKey],h=e._meta.url;if(g){var i=o(e.data.collection,f[r.idKey]);if(i)return c.resolve(b.copy(i));h=l(e._meta.url,f[r.idKey]),delete f[r.idKey]}else b.extend(f,e._meta.params);return s.run().then(function(){return d.get(h,{params:f})},k).then(function(a){var c,d=a.data;return g?(m(e.data.collection,d),c=b.copy(d)):(e.data.collection=d[r.collectionKey]||[],c=b.copy(e.data.collection)),c},k)},j.prototype.save=function(a){var c=this,e=a[r.idKey]?l(c._meta.url,a[r.idKey]):c._meta.url;return s.run().then(function(){var b=a[r.idKey]?"put":"post";return d[b](e,a)},k).then(function(a){return m(c.data.collection,a.data),b.copy(a.data)},k)},j.prototype.remove=function(a){var b=this;return s.run().then(function(){return d["delete"](l(b._meta.url,a[r.idKey]))},k).then(function(){var c=o(b.data.collection,a[r.idKey]),d=b.data.collection.indexOf(c);b.data.collection.splice(d,1)},k)},j.prototype.clearLocal=function(){var a=this;a.data.collection=[],h.$emit("$collection:clear-local",a)},function(a,b){var c=p(arguments),d=q.get(c);if(d)return d;var e=new j(a,b);return q.put(c,e),e}}]}).provider("$resourceLibrary",function(){var a=this.defaults={baseLinks:{}};this.$get=["$cacheFactory",function(c){function d(a,c){c=c?c+".":"",b.isArray(a)?b.forEach(a,function(a){f.put(c+a.rel,a.uri)}):b.isObject(a)&&b.forEach(a,function(a,b){f.put(c+b,a)})}var e=b.copy(a),f=c("resource-library");return d(e.baseLinks),{extend:d,get:f.get}}]}).controller("ngRestfulCollectionCtrl",["$scope","$attrs","$parse","$collection",function(a,c,d,e){function f(a){return a.replace(/\./g," ").replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(a,b){return 0===b?a.toLowerCase():a.toUpperCase()})}function g(a){return function(b){a&&a(b)}}var h=d(c.ngRestfulCollection)(a);a.getEditCopy=b.copy,b.forEach(h,function(c){var d=e(c.type,c.params),h=f(c.type);a[h]=b.extend({data:d.data,save:function(a,b,c){return d.save(a).then(g(b),g(c))},remove:function(a,b,c){return d.remove(a).then(g(b),g(c))},refresh:function(a,b){return d.clearLocal(),d.get().then(g(a),g(b))}},a[h]),d.get()})}]).directive("ngRestfulCollection",function(){return{restrict:"A",controller:"ngRestfulCollectionCtrl"}})}(window,angular);
//# sourceMappingURL=ng-restful-collection.min.map