!function(a,b,c){"use strict";b.module("ngRestfulCollection",[]).provider("$collection",function(){var a=this.defaults={preRequest:null,collectionKey:"data",idKey:"id"};this.$get=["$q","$http","$filter","$cacheFactory","$injector","$resourceLibrary",function(c,d,e,f,g,h){function i(a,c){this._meta={url:h.get(a),params:b.copy(c)},this.data={collection:[]}}function j(a){return c.reject(a)}function k(a,b){return a+"/"+b}function l(a,c){var d=n(a,c[q.idKey]);d?b.extend(d,c):a.push(c)}function m(a,b){var c={};return c[a]=b,c}function n(a,b){return e("filter")(a,m(q.idKey,b))[0]}function o(a){var c="";return b.forEach(a[1],function(a,b){c+=b+a}),a[0]+c}var p=f("ng-restful-collection"),q=b.copy(a),r=r?g.get(r):{run:function(){return c.when(!0)}};return i.prototype.get=function(a){var e=this,f=b.copy(a||{}),g=!!f[q.idKey],h=e._meta.url;if(g){var i=n(e.data.collection,f[q.idKey]);if(i)return c.resolve(b.copy(i));h=k(e._meta.url,f[q.idKey]),delete f[q.idKey]}else b.extend(f,e._meta.params);return r.run().then(function(){return d.get(h,{params:f})},j).then(function(a){var c,d=a.data;return g?(l(e.data.collection,d),c=b.copy(d)):(e.data.collection=d[q.collectionKey]||[],c=b.copy(e.data.collection)),c},j)},i.prototype.save=function(a){var c=this,e=a[q.idKey]?k(c._meta.url,a[q.idKey]):c._meta.url;return r.run().then(function(){var b=a[q.idKey]?"put":"post";return d[b](e,a)},j).then(function(a){return l(c.data.collection,a.data),b.copy(a.data)},j)},i.prototype.remove=function(a){var b=this;return r.run().then(function(){return d["delete"](k(b._meta.url,a[q.idKey]))},j).then(function(){var c=n(b.data.collection,a[q.idKey]),d=b.data.collection.indexOf(c);b.data.collection.splice(d,1)},j)},function(a,b){var c=o(arguments),d=p.get(c);if(d)return d;var e=new i(a,b);return p.put(c,e),e}}]}).provider("$resourceLibrary",function(){var a=this.defaults={baseLinks:{}};this.$get=["$cacheFactory",function(c){function d(a,c){c=c?c+".":"",b.isArray(a)?b.forEach(a,function(a){f.put(c+a.rel,a.uri)}):b.isObject(a)&&b.forEach(a,function(a,b){f.put(c+b,a)})}var e=b.copy(a),f=c("resource-library");return d(e.baseLinks),{extend:d,get:f.get}}]}).controller("ngRestfulCollectionCtrl",["$scope","$attrs","$parse","$collection",function(a,c,d,e){function f(a){return a.replace(/\./g," ").replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(a,b){return 0===b?a.toLowerCase():a.toUpperCase()})}function g(a){return function(b){a&&a(b)}}var h=d(c.ngRestfulCollection)(a);a.getEditCopy=b.copy,b.forEach(h,function(c){var d=e(c.type,c.params),h=f(c.type);a[h]=b.extend({data:d.data,save:function(a,b,c){d.save(a).then(g(b),g(c))},remove:function(a,b,c){d.remove(a).then(g(b),g(c))}},a[h]),d.get()})}]).directive("ngRestfulCollection",function(){return{restrict:"A",controller:"ngRestfulCollectionCtrl"}})}(window,angular);
//# sourceMappingURL=ng-restful-collection.min.map